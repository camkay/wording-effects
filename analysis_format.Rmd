---
title: "Does item format impact response?"
date: "Last updated `r Sys.Date()`"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
---

The primary aims of this study are to evaluate the effects of item wording in online, self-report personality assessment. Specifically, we intend to consider the extent to which incremental wording changes may influence differences in the distributions of responses, response times, and psychometric properties of the items. These wording changes will include a progression from using (1) trait-descriptive adjectives by themselves, (2) with the linking verb “to be” (Am…), (3) with the additional verb “to tend” (Tend to be...), and (4) with the pronoun “someone” (Am someone who tends to be…). 

Using a protocol that administers each adjective twice to the same participant (in different combinations of item format administered randomly across participants), we will use between-person analyses to compare responses using group-level data for the different formats. 

These analyses will attempt to account for delayed_memory effects by collecting data on immediate and delayed recall (5 minutes and approximately two weeks) using a delayed_memory paradigm that was developed based on a similar recall task used in the HRS (Runge et al., 2015).


```{r analysis-format-1, include = FALSE}
knitr::opts_chunk$set(warning = F, message = F)
```

```{r analysis-format-2, echo = F}
library(here) # for working with files
library(tidyverse) # for cleaning
library(janitor) # for variable names
library(lme4) # for mulitlevel modeling
library(lmerTest) # for p-values
library(emmeans) # for comparisons
library(sjPlot) # for figures
library(ggpubr) # for prettier plots
library(kableExtra) # for nicer tables
library(broom.mixed) # for tidying mulitievel models
library(papaja) # pretty numbers
```

```{r analysis-format-3, echo = F}
load(here("data/items_df.Rds"))
load(here("data/reverse_vector.Rds"))
```

## Effect of format (Block 1 data)

We used a multilevel model, nesting response within participant to account for dependence. Our primary predictor was format. Here, we use only Block 1 data; in other words, effects are largely between person, although each person contributes 31 unique data points to the analysis (one for each trait). We use the `anova` function to estimate the amount of variability in response due to format. 

```{r analysis-format-4}
item_block1 = filter(items_df, block == "1")

mod.format_b1 = lmer(response~format + (1|proid), 
                  data = item_block1)
anova(mod.format_b1)
```

```{r analysis-format-5, echo = F}
fb1_aov = anova(mod.format_b1)
fb1_sig = fb1_aov$`Pr(>F)`[[1]] < .05
fb1_aov = fb1_aov %>% 
  as_tibble() %>% 
  rename(Fval = `F value`,
         Pval = `Pr(>F)`) %>% 
  mutate(across(starts_with("P"), printp),
         across(where(is.numeric), printnum))
```

When examining only Block 1 data, item format was `r ifelse(fb1_sig, "associated", "unassociated")` with participants’ responses to personality items $(F(`r fb1_aov$NumDF[[1]]`, `r fb1_aov$DenDF[[1]]`) = `r fb1_aov$Fval[[1]]`, p = `r fb1_aov$Pval[[1]]`)$.


```{r analysis-format-6, echo = F}
# save for power analysis
save(mod.format_b1, file = here("objects/mod_format_b1.Rdata"))
```


```{r analysis-format-7, fig.cap = "Predicted response on personality items by condition, using only Block 1 data."}
plot_b1 = plot_model(mod.format_b1, type = "pred")

plot_b1$format +
  labs(x = NULL,
       y = "Average response",
       title = "Average responses by item formatting (Block 1 Data)") +
  theme_pubclean()
```

```{r analysis-format-8, fig.cap = "Distribution of responses by category, block 1 data only"}
means_by_group = item_block1 %>%
  group_by(format) %>%
  summarise(m = mean(response),
            s = sd(response))

item_block1 %>%
  ggplot(aes(x = response, fill = format)) +
  geom_histogram(bins = 6, color = "white") +
  geom_vline(aes(xintercept = m), data = means_by_group) +
  geom_text(aes(x = 1,
                y = 125,
                label = paste("M =", round(m,2),
                              "\nSD =", round(s,2))),
            data = means_by_group,
            hjust =0,
            vjust = 1) +
  facet_wrap(~format) +
  guides(fill = "none") +
  scale_x_continuous(breaks = 1:6) +
  labs(y = "Number of particpants",
       title = "Distribution of responses by format (Block 1 data)") +
  theme_pubr()
```

### One model for each adjective

We repeat this analysis separately for each trait. Because there is only one response per participant (when using only Block 1 data), we can drop the use of multilevel models and instead rely on a simple general linear model to test our hypothesis. Sepecfically, we test whether the proportion of variance attributable to item format is statistically significant.

```{r analysis-format-9, results = 'asis'}
mod_by_item_b1 = item_block1 %>%
  group_by(item) %>%
  nest() %>%
  mutate(mod = map(data, ~lm(response~format, data = .))) %>%
  mutate(aov = map(mod, anova))
```

We apply a Holm correction to the _p_-values extracted from these analyses, to adjust for the number of tests conducted. We present results in a table, which is organized by whether items were reverse-coded prior to analysis.

```{r}
summary_by_item_b1 = mod_by_item_b1 %>%
  ungroup() %>%
  mutate(tidy = map(aov, broom::tidy)) %>%
  select(item, tidy) %>%
  unnest(cols = c(tidy)) %>%
  filter(term == "format") %>%
  mutate(reverse = case_when(
    item %in% reverse ~ "Y",
    TRUE ~ "N"
  )) %>%
  mutate(p.adj = p.adjust(p.value, method = "holm"))

summary_by_item_b1 %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  arrange(reverse, item) %>%
  select(item, reverse, sumsq, meansq, df, statistic, p.value, p.adj) %>%
  kable(digits = 2,
        booktabs = T,
        col.names = c("Item", "Reverse\nScored?", "SS", "MS", "df", "F", "raw", "adj"),
        caption = "Format effects on response by item (block 1 data only)") %>%
  kable_styling()
```

### Pairwise t-tests for significant ANOVAs

When format was a significant predictor of response for an item (using the un-adjusted _p_-value here), we follow up with pairwise comparisons of format. Here we identify the items which meet this criteria. In the manuscript proper, we will only report the results for items in which format was significant, even after applying the Holm correction.

```{r analysis-format-10}
sig_item_b1 = summary_by_item_b1 %>%
  filter(p.value < .05)

sig_item_b1 = sig_item_b1$item
sig_item_b1
```

Then we create models for each adjective. We use the `emmeans` package to perform pairwise comparisons, again with a Holm correction on the _p_-values. We also plot the means and 95% confidence intervals of each mean.

**This code will have to be changed after final data collection. It is not self-adapting!**

### Talkative

```{r analysis-format-11, results = 'asis'}
talkative_model_b1 = item_block1 %>%
  filter(item == "talkative") %>%
  lm(response~format, data = .)

talkative_em_b1 = emmeans(talkative_model_b1, "format")
pairs(talkative_em_b1, adjust = "holm") %>%
  as_tibble() %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Differences in response to Talkative by format (Block 1 data only)",
        col.names = c("Contrast", "Difference in means", "SE", "df", "t", "p")) %>%
  kable_styling()
```

```{r analysis-format-12, fig.cap = "Average response to \"talkative\" by format (block 1 data only)" }
plot_model(talkative_model_b1, type = "pred", terms = c("format"))
```

## Effect of format (Block 1 and 2)

We again test whether format is a significant predictor of response. However, here we use data from both Blocks 1 and 2. As a reminder, all participants were presented with all four formats during Block 2. We expect this model to have greater power than the previous model, due to both increased sample size (twice as many data points) and because participants now provide data to all four formats, instead of only one (i.e., a within-person analysis).

```{r analysis-format-13}
items_12 = items_df %>% filter(block %in% c("1","2"))
```


```{r analysis-format-14}
mod.format_b2 = lmer(response~format + (1|proid),
                  data = items_12)
anova(mod.format_b2)
```


```{r analysis-format-14b, echo = F}
fb2_aov = anova(mod.format_b2)
fb2_sig = fb2_aov$`Pr(>F)`[[1]] < .05
fb2_aov = fb2_aov %>% 
  as_tibble() %>% 
  rename(Fval = `F value`,
         Pval = `Pr(>F)`) %>% 
  mutate(across(starts_with("P"), printp),
         across(where(is.numeric), printnum))
```

When examining both Block 1 and Block 2 data, item format was `r ifelse(fb2_sig, "associated", "unassociated")` with participants’ responses to personality items $(F(`r fb2_aov$NumDF[[1]]`, `r fb2_aov$DenDF[[1]]`) = `r fb2_aov$Fval[[1]]`, p = `r fb2_aov$Pval[[1]]`)$.

```{r analysis-format-15, echo = F}
# save for power analysis
save(mod.format_b2, file = here("objects/mod_format_b2.Rdata"))
```


```{r analysis-format-16, fig.cap = "Predicted response on personality items by condition, using only Block 1 data."}
plot_b2 = plot_model(mod.format_b2, type = "pred")

plot_b2$format +
  labs(x = NULL,
       y = "Average response",
       title = "Average responses by item formatting (Block 1 and Block 2)") +
  theme_pubclean()
```

```{r analysis-format-17, fig.cap = "Distribution of responses by category, block 1 and block 2"}
means_by_group = items_12 %>%
  group_by(format) %>%
  summarise(m = mean(response),
            s = sd(response))

items_12 %>%
  ggplot(aes(x = response, fill = format)) +
  geom_histogram(bins = 6, color = "white") +
  geom_vline(aes(xintercept = m), data = means_by_group) +
  geom_text(aes(x = 1,
                y = 200,
                label = paste("M =", round(m,2),
                              "\nSD =", round(s,2))),
            data = means_by_group,
            hjust =0,
            vjust = 1) +
  facet_wrap(~format) +
  guides(fill = "none") +
  scale_x_continuous(breaks = 1:6) +
  labs(y = "Number of particpants",
       title = "Distribution of responses by format (Block 1 and Block 2)") +
  theme_pubr()
```

### One model for each adjective

We can also repeat this analysis separately for each trait. We use the `anova` function to estimate the variability due to format and print the corresponding _F_-test.

```{r analysis-format-18, results = 'asis'}
mod_by_item_b2 = items_12 %>%
  group_by(item) %>%
  nest() %>%
  mutate(mod = map(data, ~lmer(response~format + (1|proid), data = .))) %>%
  mutate(aov = map(mod, anova))
```

To present these results, we use the `tidy` function to summarise the findings and extract just the _F_-test associated with the format variable. We calculate adjusted _p_-values using a Holm correction. We also create a column that indicates whether the item was reverse-scored; we use this to sort the table, in case a pattern emerges.

```{r analysis-format-19}
summary_by_item_b2 = mod_by_item_b2 %>%
  ungroup() %>%
  mutate(tidy = map(aov, broom::tidy)) %>%
  select(item, tidy) %>%
  unnest(cols = c(tidy)) %>%
  filter(term == "format") %>%
  mutate(reverse = case_when(
    item %in% reverse ~ "Y",
    TRUE ~ "N"
  )) %>%
  mutate(p.adj = p.adjust(p.value, method = "holm"))

summary_by_item_b2 %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  arrange(reverse, item) %>%
  select(item, reverse, sumsq, meansq, NumDF, DenDF, statistic, p.value, p.adj) %>%
  kable(digits = 2,
        col.names = c("Item", "Reverse\nScored?", "SS", "MS", "df1", "df2", "F", "raw", "adj"),
        booktabs = T, caption = "Format effects on response by item (block 1 data only)") %>%
  kable_styling() %>%
    add_header_above(c(" " = 7, "p-value" = 2))
```

### Pairwise t-tests for significant ANOVAs

Here we identify the specific items with significant differences.

```{r analysis-format-20}
sig_item_b2 = summary_by_item_b2 %>%
  filter(p.value < .05)

sig_item_b2 = sig_item_b2$item
sig_item_b2
```

Then we create models for each adjective. We use the `emmeans` package to perform pairwise comparisons, again with a Holm correction on the _p_-values. We also plot the means and 95% confidence intervals of each mean.

**This code will have to be changed after final data collection. It is not self-adapting!**

### Careless

```{r analysis-format-21, results = 'asis'}
careless_model_b2 = items_12 %>%
  filter(item == "careless") %>%
  lmer(response~format + (1|proid),
                               data = .)

careless_em_b2 = emmeans(careless_model_b2, "format")
pairs(careless_em_b2, adjust = "holm") %>%
  as_tibble() %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Differences in response to Careless by format (Block 1 and Block 2)",
        col.names = c("Contrast", "Difference in means", "SE", "df", "t", "p")) %>%
  kable_styling()
```

```{r analysis-format-22, fig.cap = "Average response to \"careless\" by format (Block 1 and Block 2)" }
plot_model(careless_model_b2, type = "pred", terms = c("format"))
```

### Thrifty

```{r analysis-format-23, results = 'asis'}
thrifty_model_b2 = items_12 %>%
  filter(item == "thrifty") %>%
  lmer(response~format + (1|proid),
                               data = .)

thrifty_em_b2 = emmeans(thrifty_model_b2, "format")
pairs(thrifty_em_b2, adjust = "holm") %>%
  as_tibble() %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Differences in response to Thifty by format (Block 1 and Block 2)",
        col.names = c("Contrast", "Difference in means", "SE", "df", "t", "p")) %>%
  kable_styling()
```

```{r analysis-format-24, fig.cap = "Average response to \"thrifty\" by format (Block 1 and Block 2)" }
plot_model(thrifty_model_b2, type = "pred", terms = c("format"))
```

## Account for memory effects (Blocks 1 and 2)

One limitation of the two-blocks model is that format effects may depend on a person's memory. For example, suppose that participants, in general, are more likely to respond with a 6 to items containing "tend to" (e.g., "tend to be outgoing") than to items that only start with "am" (e.g., "am outgoing"). However, if a participant remembers that on the first presentation of the item they selected 4, they may be more likely choose 4 again to appear consistent. This example posits that memory moderates format's effect on response. We model this possibility using participant's delayed memory scores, or their recall score 10 minutes after seeing the list of words.

```{r analysis-format-25}
mod.format_mem = lmer(response~format*delayed_memory + (1|proid),
                  data = items_12)
anova(mod.format_mem)
summary(mod.format_mem)
```


```{r analysis-format-25b, echo = F}
fmem_aov = anova(mod.format_mem)
fmem_sig1 = fmem_aov$`Pr(>F)`[[2]] < .05
fmem_sig2 = fmem_aov$`Pr(>F)`[[3]] < .05
fmem_aov = fmem_aov %>% 
  as_tibble() %>% 
  rename(Fval = `F value`,
         Pval = `Pr(>F)`) %>% 
  mutate(across(starts_with("P"), printp),
         across(where(is.numeric), printnum))
```

When examining both Block 1 and Block 2 data, memory `r ifelse(fmem_sig1, "had", "did not have")` a main effect on participant responses $(F(`r fmem_aov$NumDF[[2]]`, `r fmem_aov$DenDF[[2]]`) = `r fmem_aov$Fval[[2]]`, p = `r fmem_aov$Pval[[2]]`)$ and `r ifelse(fmem_sig2, "did", "did not")` moderate differences between formats $(F(`r fmem_aov$NumDF[[3]]`, `r fmem_aov$DenDF[[3]]`) = `r fmem_aov$Fval[[3]]`, p = `r fmem_aov$Pval[[3]]`)$.


```{r analysis-format-26, fig.cap = "Predicted response on personality items by condition after controlling for delayed_memory."}
plot_model(mod.format_mem,
           type = "pred",
           term = c("format", "delayed_memory[meansd]")) +
  geom_line() +
  labs(x = NULL,
       y = "Average response") +
  scale_color_discrete("Memory", labels = c("-1SD", "Mean", "+1SD"))+
  theme_pubclean()
```

### One model for each adjective

Again, we test this model within each trait adjective, to determine whether the moderating effect of memory is stronger for any particular trait(s).

```{r analysis-format-27, results = 'asis'}
mod_by_item_mem = items_12 %>%
  group_by(item) %>%
  nest() %>%
  mutate(mod = map(data, ~lm(response~format*delayed_memory, data = .))) %>%
  mutate(aov = map(mod, anova))

summary_by_item_mem = mod_by_item_mem %>%
  ungroup() %>%
  mutate(tidy = map(aov, broom::tidy)) %>%
  select(item, tidy) %>%
  unnest(cols = c(tidy)) %>%
  filter(term == "format:delayed_memory") %>%
  mutate(reverse = case_when(
    item %in% reverse ~ "Y",
    TRUE ~ "N"
  )) %>%
  mutate(p.adj = p.adjust(p.value, method = "holm"))

summary_by_item_mem %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  arrange(reverse, item) %>%
  select(item, reverse, sumsq, meansq, df, statistic, p.value, p.adj) %>%
  kable(digits = 2,
         col.names = c("Item", "Reverse\nScored?", "SS", "MS", "df", "F", "raw", "adj"),
        booktabs = T) %>%
  kable_styling() %>%
  add_header_above(c(" " = 6, "p-value" = 2))
```

### Pairwise t-tests for significant ANOVAs

Here we identify the specific items with significant differences.

```{r analysis-format-28}
sig_item_mem = summary_by_item_mem %>%
  filter(p.value < .05)

sig_item_mem = sig_item_mem$item
sig_item_mem
```

## Inclusion of "I" (Block 1 and Block 3)

Finally, we test whether the inclusion of the word "I" impacts item response (e.g. "I am outgoing"). We used two multilevel models, nesting response within participant to account for dependence. Our primary predictors are format and also the presence of the word "I". Because we have no specific rationale for how or why "I" would impact responses, we test both the partialled main effect of "I" as well as the interaction with format. Here, we use data from Blocks 1 and 3.

```{r analysis-format-29}
items_13 = items_df %>%
  filter(block %in% c("1","3")) %>%
  filter(condition != "A") %>%
  filter(time2 == "yes")
```

```{r analysis-format-30}
mod.format_b3_1 = lmer(response~format + i + (1|proid),
                  data = items_13)
anova(mod.format_b3_1)

mod.format_b3_2 = lmer(response~format*i + (1|proid),
                  data = items_13)
anova(mod.format_b3_2)
```

```{r analysis-format-31, echo = F}
# save for power analysis
save(mod.format_b3_2, file = here("objects/mod_format_b3.Rdata"))
```


```{r analysis-format-32, fig.cap = "Predicted response on personality items by condition, using only Block 1 data."}
plot_b3 = plot_model(mod.format_b3_2, type = "pred", terms = c("format", "i"))
plot_b3 +
  geom_line() +
  labs(x = NULL,
       y = "Average response",
       title = "Average responses by item formatting (Block 1 and Block 2)") +
  theme_pubclean()
```

```{r analysis-format-33, fig.cap = "Distribution of responses by category, block 1 and block 2"}
means_by_group = items_13 %>%
  group_by(format, i) %>%
  summarise(m = mean(response),
            s = sd(response))

items_13 %>%
  ggplot(aes(x = response, fill = i)) +
  geom_histogram(bins = 6, color = "white") +
  geom_vline(aes(xintercept = m), data = means_by_group) +
  geom_text(aes(x = 1,
                y = 100,
                label = paste("M =", round(m,2),
                              "\nSD =", round(s,2))),
            data = means_by_group,
            hjust =0,
            vjust = 1) +
  facet_grid(i~format, scales = "free") +
  guides(fill = "none") +
  scale_x_continuous(breaks = 1:6) +
  labs(y = "Number of particpants",
       title = "Distribution of responses by format (Block 1 and Block 2)") +
  theme_pubr()
```

### One model for each adjective

```{r analysis-format-34, results = 'asis'}
mod_by_item_i = items_13 %>%
  group_by(item) %>%
  nest() %>%
  mutate(mod = map(data, ~lmer(response~format + i + (1|proid), data = .))) %>%
  mutate(aov = map(mod, anova))

summary_by_item_i = mod_by_item_i %>%
  ungroup() %>%
  mutate(tidy = map(aov, broom::tidy)) %>%
  select(item, tidy) %>%
  unnest(cols = c(tidy)) %>%
  filter(term == "i") %>%
  mutate(reverse = case_when(
    item %in% reverse ~ "Y",
    TRUE ~ "N"
  )) %>%
  mutate(p.adj = p.adjust(p.value, method = "holm"))

summary_by_item_i %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  arrange(reverse, item) %>%
  select(item, reverse, sumsq, meansq, NumDF, DenDF, statistic, p.value, p.adj) %>%
  kable(digits = 2,
        col.names = c("Item", "Reverse\nScored?", "SS", "MS", "df1", "df2", "F", "raw", "adj"),
        booktabs = T, caption = "Effect of \"I\" (block 1 and 3 data)") %>%
  kable_styling() %>%
    add_header_above(c(" " = 7, "p-value" = 2))
```


```{r analysis-format-35, results = 'asis'}
mod_by_item_i2 = items_13 %>%
  group_by(item) %>%
  nest() %>%
  mutate(mod = map(data, ~lmer(response~format*i + (1|proid), data = .))) %>%
  mutate(aov = map(mod, anova))

summary_by_item_i2 = mod_by_item_i2 %>%
  ungroup() %>%
  mutate(tidy = map(aov, broom::tidy)) %>%
  select(item, tidy) %>%
  unnest(cols = c(tidy)) %>%
  filter(term == "format:i") %>%
  mutate(reverse = case_when(
    item %in% reverse ~ "Y",
    TRUE ~ "N"
  )) %>%
  mutate(p.adj = p.adjust(p.value, method = "holm"))

summary_by_item_i2 %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  arrange(reverse, item) %>%
  select(item, reverse, sumsq, meansq, NumDF, DenDF, statistic, p.value, p.adj) %>%
  kable(digits = 2,
        col.names = c("Item", "Reverse\nScored?", "SS", "MS", "df1", "df2", "F", "raw", "adj"),
        booktabs = T, caption = "Interaction of format and \"I\" (block 1 and 3 data)") %>%
  kable_styling() %>%
    add_header_above(c(" " = 7, "p-value" = 2))
```

### Pairwise t-tests for significant ANOVAs

Here we identify the specific items with significant differences.

```{r analysis-format-36}
sig_item_i = summary_by_item_i %>%
  filter(p.value < .05)

sig_item_i = sig_item_i$item
sig_item_i
```

### Curious

```{r analysis-format-37, results = 'asis'}
curious_model_i = items_13 %>%
  filter(item == "curious") %>%
  lmer(response~format*i + (1|proid),
                               data = .)

curious_model_i %>%
  tidy() %>%
  mutate(term = str_replace(term, "\n", " "),
         term = str_replace(term, "format", ""),
         term = str_replace(term, "iPresent", "I")) %>%
  filter(is.na(group)) %>%
  select(-effect, -group) %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Interaction of format and \"I\"",
        col.names = c("Term", "Estimate", "SE",  "t", "df", "p")) %>%
  kable_styling()
```

```{r analysis-format-38}
plot_model(curious_model_i, type = "pred",
           terms = c("format", "i")) +
  geom_line()
```

### Lively

```{r analysis-format-39, results = 'asis'}
lively_model_i = items_13 %>%
  filter(item == "lively") %>%
  lmer(response~format*i + (1|proid),
                               data = .)

lively_model_i %>%
  tidy() %>%
  mutate(term = str_replace(term, "\n", " "),
         term = str_replace(term, "format", ""),
         term = str_replace(term, "iPresent", "I")) %>%
  filter(is.na(group)) %>%
  select(-effect, -group) %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Interaction of format and \"I\"",
        col.names = c("Term", "Estimate", "SE",  "t", "df", "p")) %>%
  kable_styling()
```

```{r analysis-format-40}
plot_model(lively_model_i, type = "pred",
           terms = c("format", "i")) +
  geom_line()
```

### Responsible

```{r analysis-format-41, results = 'asis'}
responsible_model_i = items_13 %>%
  filter(item == "responsible") %>%
  lmer(response~format*i + (1|proid),
                               data = .)

responsible_model_i %>%
  tidy() %>%
  mutate(term = str_replace(term, "\n", " "),
         term = str_replace(term, "format", ""),
         term = str_replace(term, "iPresent", "I")) %>%
  filter(is.na(group)) %>%
  select(-effect, -group) %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Interaction of format and \"I\"",
        col.names = c("Term", "Estimate", "SE",  "t", "df", "p")) %>%
  kable_styling()
```

```{r analysis-format-42}
plot_model(responsible_model_i, type = "pred",
           terms = c("format", "i")) +
  geom_line()
```

### Sympathetic

```{r analysis-format-43, results = 'asis'}
sympathetic_model_i = items_13 %>%
  filter(item == "sympathetic") %>%
  lmer(response~format*i + (1|proid),
                               data = .)

sympathetic_model_i %>%
  tidy() %>%
  mutate(term = str_replace(term, "\n", " "),
         term = str_replace(term, "format", ""),
         term = str_replace(term, "iPresent", "I")) %>%
  filter(is.na(group)) %>%
  select(-effect, -group) %>%
  mutate(across( starts_with("p"), printp )) %>% # format p-values
  kable(booktabs = T,
        digits = 2,
        caption = "Interaction of format and \"I\"",
        col.names = c("Term", "Estimate", "SE",  "t", "df", "p")) %>%
  kable_styling()
```

```{r analysis-format-44}
plot_model(sympathetic_model_i, type = "pred",
           terms = c("format", "i")) +
  geom_line()
```
