<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Power analysis</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">On item wording effects</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="1-cleaning.html">Data cleaning</a>
</li>
<li>
  <a href="descriptives.html">Descriptives</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="analysis_format.html">Does item formatting affect response?</a>
    </li>
    <li>
      <a href="internal.html">Does item formatting affect internal consistency?</a>
    </li>
    <li>
      <a href="test_retest.html">Does item formatting affect test-retest reliability?</a>
    </li>
    <li>
      <a href="timing_format.html">Does timing differ across format?</a>
    </li>
    <li>
      <a href="device.html">Does device type affect response and timing?</a>
    </li>
  </ul>
</li>
<li>
  <a href="power.html">Power analysis</a>
</li>
<li>
  <a href="workspace.html">R version and packages</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pie-lab/wording-effects">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Power analysis</h1>
<h4 class="date">Last updated 2021-08-25</h4>

</div>


<p>We conduct power analyses for the main research question – does formatting affect response to personality items – using a simulation method. That is, we generate datasets of varying sample sizes (from as few as 50 participants per condition to as many as 100), then simulate responses based on the models fit to the pilot data.</p>
<p>Here we set the sample sizes we’ll test, as well as the number of simulations we’ll run for each sample size.</p>
<pre class="r"><code>sample_sizes = seq(50, 500, 25)

n_sims = 1000</code></pre>
<div id="model-1" class="section level2">
<h2>Model 1</h2>
<p>To simplify our code, we write a function that simulates responses to model 1 based on a given sample size, N, and number of repetitions.</p>
<pre class="r"><code># function to simulate mod.format_b1

sim_format_b1 = function(n, sims){
  p_vals = numeric(length = sims)
  
  sim_a = expand_grid(
    proid = as.character(1:n),
    item = c(1:33),
    format = &quot;Adjective\nOnly&quot;
  )

  sim_b = expand_grid(
    proid = as.character((n+1):(2*n)),
    item = c(1:33),
    format = &quot;Am\nAdjective&quot;
  )
  
  sim_c = expand_grid(
    proid = as.character(((2*n)+1):(3*n)),
    item = c(1:33),
    format = &quot;Tend to be\nAdjective&quot;
  )
  sim_d = expand_grid(
    proid = as.character(((3*n)+1):(4*n)),
    item = c(1:33),
    format = &quot;Am someone\nwho tends to be\nAdjective&quot;
  )
  
  sim_data = rbind(sim_a, sim_b) %&gt;% rbind(sim_c) %&gt;% rbind(sim_d)
  for (i in 1:sims){
    sim_data$response = simulate(mod.format_b1, newdata = sim_data, allow.new.levels = T)[,1]
    sim_mod = lmer(response~format + (1|proid), data = sim_data)
    p_vals[i] = anova(sim_mod)[&quot;format&quot;, 6]}
  return(p_vals)
}</code></pre>
<p>Next we identify the sample sizes for simulation (from 50 to 500 by 25) and create a data frame to hold the results. Power represents the proportion of simulations for which <em>p</em> is less than .05.</p>
<pre class="r"><code># simulate at various sample sizes
power_df = data.frame(
  N = sample_sizes,
  power = 0
)</code></pre>
<p>Here we (inefficiently) loop through all sample sizes and calculate power. Final results are presented in Figure @ref(fig:plotpower1).</p>
<pre class="r"><code>set.seed(20210729)
for(i in sample_sizes){
  pvalues = sim_format_b1(i, n_sims)
  sig = ifelse(pvalues &lt; .05, 1, 0)
  power_df$power[power_df$N == i] &lt;- sum(sig)/n_sims
}</code></pre>
<p><img src="power_files/figure-html/plotpower1-1.png" width="672" /></p>
<pre class="r"><code>#identify minimum sample size

power_df_min = power_df %&gt;% 
  filter(power &gt; .95)

N_min = min(power_df_min$N)</code></pre>
<p>The simulation suggests that power would be over the threshold of .95 with a sample size of 150 participants per condition.</p>
</div>
<div id="model-2" class="section level2">
<h2>Model 2</h2>
<p>Here we repeat the process for our second model, which uses both blocks of data from Time 1 (i.e., Blocks 1 and 2).</p>
<pre class="r"><code># function to simulate mod.format_b2

sim_format_b2 = function(n, sims){
  p_vals = numeric(length = sims)
  
  sim_a_b2 = expand_grid(
    proid = as.character(1:n),
    item = c(1:33),
    format = &quot;Adjective\nOnly&quot;,
    block = &quot;1&quot;
  )

  sim_b_b2 = expand_grid(
    proid = as.character((n+1):(2*n)),
    item = c(1:33),
    format = &quot;Am\nAdjective&quot;,
    block = &quot;1&quot;
  )
  
  sim_c_b2 = expand_grid(
    proid = as.character(((2*n)+1):(3*n)),
    item = c(1:33),
    format = &quot;Tend to be\nAdjective&quot;,
    block = &quot;1&quot;
  )
  sim_d_b2 = expand_grid(
    proid = as.character(((3*n)+1):(4*n)),
    item = c(1:33),
    format = &quot;Am someone\nwho tends to be\nAdjective&quot;,
    block = &quot;1&quot;
  )
  sim_b2 = expand_grid(
    proid = as.character(1:(4*n)),
    item = c(1:33),
    block = &quot;2&quot;
  )
  sim_b2$format = sample(
    x = c(&quot;Adjective\nOnly&quot;,
          &quot;Am\nAdjective&quot;,
          &quot;Tend to be\nAdjective&quot;,
          &quot;Am someone\nwho tends to be\nAdjective&quot;), 
    size = 33*n*4,
    replace = TRUE
  )
  
  sim_data = full_join(sim_a_b2, sim_b_b2) %&gt;% 
    full_join(sim_c_b2) %&gt;% 
    full_join(sim_d_b2) %&gt;% 
    full_join(sim_b2)
  
  for (i in 1:sims){
    sim_data$response = simulate(mod.format_b2, 
                                 newdata = sim_data, 
                                 allow.new.levels = T)[,1]
    sim_mod = lmer(response~format + (1|proid), 
                   data = sim_data)
    p_vals[i] = anova(sim_mod)[&quot;format&quot;, 6]}
  return(p_vals)
}</code></pre>
<p>We use the same sample sizes and simulation length for these analyses, so we start by creating a new data frame.</p>
<pre class="r"><code>power_df_2 = data.frame(
  N = sample_sizes,
  power = 0
)</code></pre>
<p>Here we (inefficiently) loop through all sample sizes and calculate power. Final results are depicted in Figure @ref(fig:plotpower2).</p>
<pre class="r"><code>set.seed(20210729)
for(i in sample_sizes){
  pvalues = sim_format_b2(i, n_sims)
  sig = ifelse(pvalues &lt; .05, 1, 0)
  power_df_2$power[power_df_2$N == i] &lt;- sum(sig)/n_sims
}</code></pre>
<p><img src="power_files/figure-html/plotpower2-1.png" width="672" /></p>
<pre class="r"><code>#identify minimum sample size

power_df2_min = power_df_2 %&gt;% 
  filter(power &gt; .95)

N_min2 = min(power_df2_min$N)</code></pre>
<p>The simulation suggests that power would be over the threshold of .95 with a sample size of 75 participants per condition.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
